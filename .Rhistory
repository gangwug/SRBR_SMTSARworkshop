library(MetaCycle)
?meta2d
plot(1:10,1:10, type="b", pch=1:10)
plot(1:10,1:10, type="b", pch=1:10, col=1:10)
?rnorm
library(MetaCycle)
?meta2d
q()
2^6.5
2^6.5
10^1.8
3600*24
9.61-3.94/21.14*20.36
20.36*0.25
27.4*0.25
25.6/27.2*27.4
25.6/27.2*27.4 - 27.4 - 1.4
3.6/29.6*27.4-1.4
8.3/25.7*27.4 - 1.4
8.0/23.7*27.4 - 1.4
6/31
library(affy)
library(affy)
?mas5calls
?mas5.detection
data(Dilution)
require(affydata)
data(Dilution)
install.packages("affydata")
require(affydata)
library(MetaCycle)
?meta2d
library(gcrma)
?gcrma
?p.adjust
?write.csv
10000/8
1250/24
library(shiny)
?runGitHub
runGitHub("MetaCycleApp", "gangwug")
runGitHub("MetaCycleApp", "gangwug")
library(MetaCycle)
?meta2d
3333/3667
218/260
35/63
library(shiny)
runGitHub("MetaCycleApp", "gangwug")
runGitHub("MetaCycleApp", "gangwug")
0.479*24*10
0.665*24*10
35/63
218/260
3333/3667
?MetaCycle
dataD <- read.csv("/Users/wug2/Desktop/LEMScreen.csv", stringsAsFactors = FALSE)
dataD
pva <- dataD[10,]
pva
qva <- p.adjust(pva, method = "BH")
?p.adjust
qva
outD <- rbind(dataD, qva)
outD
?write.csv
write.csv(outD, file="/Users/wug2/Desktop/LEMScreenBHq.csv")
dataD
tep <- c(100,100,100,100,99,99,98,98)
mean(tep)
?grepl
#### This temporary analysis is a quick analysis for grant application
rm(list=ls())
library(dplyr)
## get the the file list
indir <- "/Users/wug2/Work/UC/DATA/PCOR/application/meta2d/process/ArrayMeta3d/"
infiles <- dir(indir)
infiles
infiles <- grep("meta3dSubjectID_", infiles, fixed = TRUE, value = TRUE)
infiles
infiles <- dir(indir)
infiles <- grep("^meta3dSubjectID_", infiles, perl = TRUE, fixed = TRUE, value = TRUE)
infiles <- dir(indir)
infiles <- grep("\\^meta3dSubjectID_", infiles, perl = TRUE, fixed = TRUE, value = TRUE)
infiles <- dir(indir)
infiles <- grep("\^meta3dSubjectID_", infiles, perl = TRUE, fixed = TRUE, value = TRUE)
infiles <- dir(indir)
infiles <- grep("^meta3dSubjectID_", infiles, perl = TRUE, value = TRUE)
infiles
tepD <- read.delim(paste(indir, "/", infiles[1], sep=""))
dim(tepD)
head(tepD)
infiles
i=1
tepname <- infiles[i]
tepname <- gsub("_GSE54652_RayPNAS2014array.DesignFile2.txt", "", fixed = TRUE, tepname)
tepname
tags <- NULL
for (i in 1:length(infiles))
{
tepname <- infiles[i]
tepname <- gsub("_GSE54652_RayPNAS2014array.DesignFile2.txt", "", fixed = TRUE, tepname)
tepname <- gsub("meta3dSubjectID_", "", fixed = TRUE, tepname)
tags <- c(tags, tepname)
}
tags
length(tags)
j=1
tepD <- read.delim(infiles[j])
tepD <- read.delim(paste(indir, "/", infiles[j], sep="") )
head(tepD)
baseM <- NULL
for (j in 1:length(infiles))
{
tepD <- read.delim(paste(indir, "/", infiles[j], sep="") )
baseM <- cbind(baseM, tepD$meta2d_Base)
}
dim(baseM)
head(baseM)
?colorRampPalette
colorRamp(c("red", "green"))( (0:4)/4 )
colorRampPalette(c("blue", "red"))( 4 )
?plot
pdf("~/Work/UC/DATA/COPT/Tep/NFAT/bhtcArrayBaseDensity.pdf",width=3,height=3,pointsize=12)
par(mai=c(0.5,0.4,0.3,0.1),mgp=c(1.5,0.25,0),tck=-0.01)
basecol <- colorRampPalette(c("blue", "red"))( length(tags) )
plot(x=NULL,y=NULL,xlim=c(0,4.5),ylim=c(0,0.85),xlab="",ylab="",main="bhtc_ArrayBase")
for (k in 1:ncol(baseM))
{
par(new=T)
plot(density(log10(baseM[,i])),xlim=c(0,4.5),ylim=c(0,0.85),type="l", col=basecol[k], xlab="",ylab="",main="")
}
mtext("Log10(Intensity)",side=1,line=1.2)
abline(v=2.3,lty=3)
text(2.6,0.025,labels="2.3",cex=0.65)
legend("topright", legend=tags, col=basecol, lty=1, bty="n", cex=0.3)
dev.off()
head(baseM)
dim(baseM)
pdf("~/Work/UC/DATA/COPT/Tep/NFAT/bhtcArrayBaseDensity.pdf",width=3,height=3,pointsize=12)
par(mai=c(0.5,0.4,0.3,0.1),mgp=c(1.5,0.25,0),tck=-0.01)
basecol <- colorRampPalette(c("blue", "red"))( length(tags) )
plot(x=NULL,y=NULL,xlim=c(0,4.5),ylim=c(0,0.85),xlab="",ylab="",main="bhtc_ArrayBase")
for (k in 1:ncol(baseM))
{
par(new=T)
plot(density(log10(baseM[,k])),xlim=c(0,4.5),ylim=c(0,0.85),type="l", col=basecol[k], xlab="",ylab="",main="")
}
mtext("Log10(Intensity)",side=1,line=1.2)
abline(v=2.3,lty=3)
text(2.6,0.025,labels="2.3",cex=0.65)
legend("topright", legend=tags, col=basecol, lty=1, bty="n", cex=0.3)
dev.off()
pdf("~/Work/UC/DATA/COPT/Tep/NFAT/bhtcArrayBaseDensity.pdf",width=3,height=3,pointsize=12)
par(mai=c(0.5,0.4,0.3,0.1),mgp=c(1.5,0.25,0),tck=-0.01)
basecol <- colorRampPalette(c("blue", "red"))( length(tags) )
plot(x=NULL,y=NULL,xlim=c(0,4.5),ylim=c(0,1.05),xlab="",ylab="",main="bhtc_ArrayBase")
for (k in 1:ncol(baseM))
{
par(new=T)
plot(density(log10(baseM[,k])),xlim=c(0,4.5),ylim=c(0,1.05),type="l", col=basecol[k], xlab="",ylab="",main="")
}
mtext("Log10(Intensity)",side=1,line=1.2)
abline(v=2,lty=3)
text(2.3,0.025,labels="2",cex=0.65)
legend("topright", legend=tags, col=basecol, lty=1, bty="n", cex=0.3)
dev.off()
annoD <- read.delim("~/Work/UC/DATA/PCOR/application/meta2d/datasets/MoGene-1_0-st-v1/MoGene-1_0-st-v1.na35.mm10.transcript.AnnoInf.txt/")
annoD <- read.delim("~/Work/UC/DATA/PCOR/application/meta2d/datasets/MoGene-1_0-st-v1/MoGene-1_0-st-v1.na35.mm10.transcript.AnnoInf.txt")
dim(annoD)
head(annoD)
annoD <- filter(annoD, annotatedGeneNum=1)
annoD <- read.delim("~/Work/UC/DATA/PCOR/application/meta2d/datasets/MoGene-1_0-st-v1/MoGene-1_0-st-v1.na35.mm10.transcript.AnnoInf.txt")
annoD <- filter(annoD, annotatedGeneNum==1)
dim(annoD)
head(annoD)
tail(annoD)
i=1
tepD <- read.delim(paste(indir, infiles[i], sep=""))
head(tepD)
dim(annoD)
tepD <- read.delim(paste(indir, infiles[i], sep=""))
#expression above cut-off
tepD <- filter(tepD, meta2d_Base > basecut)
#with unique annotation
outD <- inner_join(tepD, annoD, by=c("CycID" = "transcriptID"))
basecut <- 100
tepD <- read.delim(paste(indir, infiles[i], sep=""))
#expression above cut-off
tepD <- filter(tepD, meta2d_Base > basecut)
#with unique annotation
outD <- inner_join(tepD, annoD, by=c("CycID" = "transcriptID"))
head(outD)
dim(outD)
?inner_join
tepD <- read.delim(paste(indir, infiles[i], sep=""))
#expression above cut-off
expD <- filter(tepD, meta2d_Base > basecut)
#with unique annotation
outD <- inner_join(expD, annoD, by=c("CycID" = "transcriptID"))
remainD <- anti_join(tepD, outD, by="CycID")
head(outD)
dim(outD)
dim(remainD)
dim(tepD)
12398+23158
?p.adjust
infiles[i]
?write.table
i
tepD <- read.delim(paste(indir, infiles[i], sep=""))
#expression above cut-off
expD <- filter(tepD, meta2d_Base > basecut)
#with unique annotation
outD <- inner_join(expD, annoD, by=c("CycID" = "transcriptID"))
#recalculate FDR
newfdr <- p.adjust(outD$JTK_pvalue, method="BH")
outD$JTK_BH.Q <- newfdr
#those remaining transcripts
remainD <- anti_join(tepD, outD, by="CycID")
#output selected transcripts and remaining transcripts
outname <- infiles[i]
outname <- gsub(".txt", "", outname, fixed = TRUE)
outname
write.table(outD, file= paste(indir, "/", outname, ".ExpAnno.txt", sep=""), quote = FALSE, sep = "\t", row.names = FALSE)
write.table(remainD, file=paste(indir, "/", outname, ".ExpAnno_Remaining.txt", sep=""), quote = FALSE, sep = "\t", row.names = FALSE)
dim(outD)
dim(remainD)
dim(tepD)
annoD <- read.delim("~/Work/UC/DATA/PCOR/application/meta2d/datasets/MoGene-1_0-st-v1/MoGene-1_0-st-v1.na35.mm10.transcript.AnnoInf.txt")
annoD <- filter(annoD, annotatedGeneNum==1)
basecut <- 100
for (i in 1:length(infiles))
{
tepD <- read.delim(paste(indir, infiles[i], sep=""))
#expression above cut-off
expD <- filter(tepD, meta2d_Base > basecut)
#with unique annotation
outD <- inner_join(expD, annoD, by=c("CycID" = "transcriptID"))
#recalculate FDR
newfdr <- p.adjust(outD$JTK_pvalue, method="BH")
outD$JTK_BH.Q <- newfdr
#those remaining transcripts
remainD <- anti_join(tepD, outD, by="CycID")
#output selected transcripts and remaining transcripts
outname <- infiles[i]
outname <- gsub(".txt", "", outname, fixed = TRUE)
write.table(outD, file= paste(indir, "/", outname, ".ExpAnno.txt", sep=""), quote = FALSE, sep = "\t", row.names = FALSE)
write.table(remainD, file=paste(indir, "/", outname, ".ExpAnno_Remaining.txt", sep=""), quote = FALSE, sep = "\t", row.names = FALSE)
}
indir
i
dim(outD)
dim(remainD)
12513+23043
dim(tepD)
rm(list=ls())
q()
?write.csv
library("shiny")
library("MetaCycle")
library("dplyr")
library("ggplot2")
library("cowplot")
getwd()
library(MetaCycle)
?meta2d
cycMouseLiverRNA
cycMouseLiverProtein
cycMouseLiverProtein
cycYeastCycle
install.packages("shiny")
library(shiny)
runGitHub("MetaCycleApp", "gangwug")
library(ggplot2)
library(cowplot)
library(cowplot)
setwd("~/Desktop/MetaCycleApp-master/")
getwd()
file.edit("ui.R")
runApp()
file.edit("server.R")
runApp()
setwd("../")
file.edit("ui.R")
file.edit("./MetaCycleApp-master/ui.R")
dir()
runApp('./MetaCycleApp-master')
dir()
setwd("~/Work/UC/Tools/SharedFiles/gitdata/SRBR_SMTSAworkshop/demo/")
getwd()
library("shiny")
# open 'ui.R' script
file.edit("~/Desktop/MetaCycleApp-master/ui.R")
runApp('~/Desktop/MetaCycleApp-master')
runApp('~/Desktop/MetaCycleApp-master')
runApp('~/Desktop/MetaCycleApp-master')
runApp("~/Desktop/MetaCycleApp-master/")
?runApp
runApp("~/Desktop/MetaCycleApp-master")
setwd("~")
dir()
getwd()
runApp("~/Desktop/MetaCycleApp-master")
runApp("~/Desktop/MetaCycleApp-master")
setwd("~/Work/UC/Tools/SharedFiles/gitdata/SRBR_SMTSAworkshop/")
library(shiny)
runApp("~/Desktop/SRBR_SMTSAworkshop-master/")
runApp("~/Desktop/MetaCycleApp-master/")
runApp("~/Desktop/MetaCycleApp-master/")
dir()
runApp("~/Desktop/MetaCycleApp-master/")
runApp("~/Desktop/MetaCycleApp-master/")
getwd()
dir()
source("./R/fig.R")
source("./R/ fig.R")
